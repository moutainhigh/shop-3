<?xml version="1.0" encoding="GBK"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- create by autoCode,v1.0.0 --><mapper namespace="manage.product">	  <resultMap type="com.tuisitang.modules.shop.entity.ProductCatalogRela" id="ProductCatalogRelaMap">    		 <result column="productId" property="productId"/>    		 <result column="catalogId" property="catalogId"/>        </resultMap> 		 <resultMap type="net.jeeshop.services.manage.product.bean.Product" id="ProductMap"> 		<id column="id" property="id" />		<result column="name" property="name" />		<result column="introduce" property="introduce" />		<result column="price" property="price" />		<result column="nowPrice" property="nowPrice" />		<result column="maxPicture" property="maxPicture" />		<result column="images" property="images" />		<result column="score" property="score" />		<result column="isnew" property="isnew" />		<result column="sale" property="sale" />		<result column="isRecommend" property="isRecommend" />		<result column="unit" property="unit" />		<result column="picture" property="picture" />		<result column="createAccount" property="createAccount" />		<result column="createtime" property="createtime" />		<result column="updateAccount" property="updateAccount" />		<result column="updatetime" property="updatetime" />		<result column="activityID" property="activityID" />		<result column="giftID" property="giftID" />		<result column="searchKey" property="searchKey" />		<result column="isTimePromotion" property="isTimePromotion" />		<result column="status" property="status" />		<result column="productHTML" property="productHTML" />		<result column="title" property="title" />		<result column="description" property="description" />		<result column="keywords" property="keywords" />		<result column="sellcount" property="sellcount" />		<result column="stock" property="stock" />		<result column="hit" property="hit" />		<collection property="productCatalogRelas" ofType="com.tuisitang.modules.shop.entity.ProductCatalogRela" resultMap="ProductCatalogRelaMap" />	</resultMap> 		<select id="manage.product.selectPageList" parameterType="net.jeeshop.services.manage.product.bean.Product" resultMap="ProductMap">	 select distinct p.id,p.name,p.introduce,p.price,p.nowPrice,p.picture,DATE_FORMAT(p.createtime,'%Y-%m-%d') createtime,p.createAccount,p.updateAccount,p.updatetime,p.isnew,p.sale,p.status,	 	p.productHTML,p.maxPicture,p.images,ts.sellcount,s.stock,p.searchKey,p.title,p.description,p.keywords,p.activityID,p.unit,p.score ,p.isTimePromotion ,p.isRecommend,p.giftID,	 	p.id as productId	 	<!-- <if test="queryCatalogIDs != null and queryCatalogIDs.size &gt; 0"> 	 	,r.catalogId   	 	</if>	 	<if test="queryCatalogIDs == null or queryCatalogIDs.size == 0">	 	    ,0 as catalogId 	    </if> -->		 from t_product p		 <!-- left join t_product_catalog_rela r		 on p.id = r.productId -->		 <if test="queryCatalogIDs != null and queryCatalogIDs.size &gt; 0">		  join t_product_catalog_rela r on p.id= r.productId  and r.catalogId in <foreach item="item" index="index" collection="queryCatalogIDs" open="(" separator="," close=")">#{item}</foreach>		</if>		 left join t_product_stock s		 on p.id = s.productId		 left join t_product_hit h		 on p.id = h.productId		 left join t_product_sellcount ts		 on p.id = ts.productId 		 where 1 = 1	 <if test="id!=null and id!=''">		 	and p.id=#{id}		 </if><!-- 	 <if test="catalogID!=null and catalogID!=''"> --><!-- 	 	and catalogID=#{catalogID} --><!-- 	 </if> -->	 <if test="status!=0">	 	and status=#{status}	 </if>	 <if test="isRecommend!=null and isRecommend!=''">	 	and isRecommend=#{isRecommend}	 </if>	 <if test="isnew!=null and isnew!=''">	 	and isnew=#{isnew}	 </if>	 <if test="sale!=null and sale!=''">	 	and sale=#{sale}	 </if>	 <if test="name!=null and name!=''">			and p.name like CONCAT('%','${name}','%' ) 	 </if>	 <if test="startDate!=null and startDate!=''">		and createtime &gt;= #{startDate}	 </if>	 <if test="endDate!=null and endDate!=''">		and createtime &lt;= #{endDate}	 </if>	 <!-- <if test="queryCatalogIDs!=null and queryCatalogIDs.size &gt; 0">	  and r.catalogId in <foreach item="item" index="index" collection="queryCatalogIDs" open="(" separator="," close=")">    			#{item}   		</foreach>	 </if> -->	 <if test="selectOutOfStockProduct">	 	and status=2 and s.stock &lt;= 0 	 </if>	 order by p.id asc 	 limit #{offset},#{pageSize} 	</select> 	<select id="manage.product.selectPageCount" parameterType="net.jeeshop.services.manage.product.bean.Product" resultType="java.lang.Integer">	    select count(1)  		from (select distinct(p.id)		  from t_product p 		<if test="queryCatalogIDs != null and queryCatalogIDs.size &gt; 0">		  join t_product_catalog_rela r on p.id= r.productId  and r.catalogId in <foreach item="item" index="index" collection="queryCatalogIDs" open="(" separator="," close=")">#{item}</foreach>		</if>  		  left join t_product_stock s on p.id= s.productId		 where 1=1 	 <if test="id!=null and id!=''">		 	and p.id=#{id}		 </if><!-- 	 <if test="catalogID!=null and catalogID!=''"> --><!-- 	 	and catalogID=#{catalogID} --><!-- 	 </if> -->	 <if test="status!=0">	 	and p.status=#{status}	 </if>	 <if test="isnew!=null and isnew!=''">	 	and isnew=#{isnew}	 </if>	 <if test="sale!=null and sale!=''">	 	and sale=#{sale}	 </if>	 <if test="isRecommend!=null and isRecommend!=''">	 	and isRecommend=#{isRecommend}	 </if>	 <if test="name!=null and name!=''">		and p.name like CONCAT('%','${name}','%' ) 	 </if>	 <if test="startDate!=null and startDate!=''">		and createtime &gt;= #{startDate}	 </if>	 <if test="endDate!=null and endDate!=''">		and createtime &lt;= #{endDate}	 </if>	 <!-- <if test="queryCatalogIDs!=null and queryCatalogIDs.size &gt; 0">	  and r.catalogId in <foreach item="item" index="index" collection="queryCatalogIDs" open="(" separator="," close=")">    			#{item}   		</foreach>	 </if> -->	 <if test="selectOutOfStockProduct">	 	and status=2 and s.stock &lt;= 0 	 </if>	 ) a	</select>		<select id="manage.product.selectList" parameterType="net.jeeshop.services.manage.product.bean.Product" resultMap="ProductMap">	select p.id,p.name,p.introduce,p.price,p.nowPrice,p.picture,DATE_FORMAT(p.createtime,'%Y-%m-%d') createtime,p.createAccount,p.updateAccount,p.updatetime,p.isnew,p.sale,p.status,	 	p.productHTML,p.maxPicture,p.images,ts.sellcount,s.stock,p.searchKey,p.title,p.description,p.keywords,p.activityID,p.unit,p.score ,p.isTimePromotion ,p.isRecommend,p.giftID,	 	r.productId, r.catalogId      		 from t_product p		 left join t_product_catalog_rela r		 on p.id = r.productId		 left join t_product_stock s		 on p.id = s.productId		 left join t_product_hit h		 on p.id = h.productId		 left join t_product_sellcount ts		 on p.id = ts.productId 		 where 1 = 1	 <if test="id!=null and id!=''">		 	and id=#{id}	</if>	 <if test="catalogID!=null and catalogID!=''">	 	and r.catalogId=#{catalogID}	 </if>	 <if test="status!=0">	 	and status=#{status}	 </if>	 <if test="name!=null and name!=''">			and p.name like CONCAT('%','${name}','%' ) 	 </if>	 <if test="ids!=null and ids!=''">	 	and id in (${ids}) 	 </if> order by id desc 	</select> 	 	<insert id="manage.product.insertStock" parameterType="com.tuisitang.modules.shop.entity.ProductStockInfo"> 		insert into t_product_stock		(		productId, stock)		values		(		#{productId},#{stock}		) 	</insert> 	 	<insert id="manage.product.insertProductCatalog" parameterType="com.tuisitang.modules.shop.entity.ProductCatalogRela"> 		insert into t_product_catalog_rela		(		productId, catalogId)		values		(		#{productId},#{catalogId}		) 	</insert> 	 	<insert id="manage.product.insertSellCount" parameterType="com.tuisitang.modules.shop.entity.ProductSellCount"> 		insert into t_product_sellCount		(		productId, sellcount)		values		(		#{productId},#{sellCount}		) 	</insert> 	 	<insert id="manage.product.insertHit" parameterType="com.tuisitang.modules.shop.entity.ProductHit"> 		insert into t_product_hit		(		productId, hit)		values		(		#{productId},#{hit}		) 	</insert> 	 	<delete id="manage.product.deleteProductCatalog" parameterType="long">        delete from t_product_catalog_rela  where productId = #{productId}    </delete> 	 	<update id="manage.product.updateStock" parameterType="com.tuisitang.modules.shop.entity.ProductStockInfo"> 		update t_product_stock s		  set s.stock = #{stock}	    where s.productId = #{productId} 	</update> 	 	<update id="manage.product.updateSellCount" parameterType="com.tuisitang.modules.shop.entity.ProductSellCount"> 		update t_product_sellcount s		  set s.sellcount = #{sellCount}	    where s.productId = #{productId} 	</update> 	 	<update id="manage.product.updateHit" parameterType="com.tuisitang.modules.shop.entity.ProductHit"> 		update t_product_hit h		  set h.hit = #{hit}	    where h.productId = #{productId} 	</update> 		<insert id="manage.product.insert" parameterType="net.jeeshop.services.manage.product.bean.Product" useGeneratedKeys="true" keyProperty="id">		insert into t_product		(		id,createAccount,createtime,status		<if test="catalogID!=null and catalogID!=''">		,catalogID		</if>		<if test="name!=null and name!=''">		,name		</if>		<if test="introduce!=null and introduce!=''">		,introduce		</if>		<if test="price!=null and price!=''">		,price		</if>		<if test="nowPrice!=null and nowPrice!=''">		,nowPrice		</if>		<if test="picture!=null and picture!=''">		,picture		</if>		<if test="maxPicture!=null and maxPicture!=''">		,maxPicture		</if>		<if test="productHTML !=null and productHTML !=''">		,productHTML		</if>		<if test="score!=0">		,score		</if>		<if test="isnew!=null and isnew!=''">		,isnew		</if>		<if test="sale!=null and sale!=''">		,sale		</if>		<if test="isRecommend!=null and isRecommend!=''">		,isRecommend		</if>		<if test="hit!=0">		,hit		</if>		<if test="unit!=null and unit!=''">		,unit		</if>		<if test="activityID!=null and activityID!=''">		,activityID		</if>		<if test="images!=null and images!=''">		,images		</if>		<if test="searchKey!=null and searchKey!=''">		,searchKey		</if>		<if test="title!=null and title!=''">		,title		</if>		<if test="description!=null and description!=''">		,description		</if>		<if test="keywords!=null and keywords!=''">		,keywords		</if>		<if test="isTimePromotion!=null and isTimePromotion!=''">		,isTimePromotion		</if>		<if test="giftID!=null">		,giftID		</if>				)		values		(		id,#{createAccount},now(),#{status}		<if test="catalogID!=null and catalogID!=''">		,#{catalogID}		</if>		<if test="name !=null and name !=''">		,#{name}		</if>		<if test="introduce !=null and introduce !=''">		,#{introduce}		</if>		<if test="price !=null and price !=''">		,#{price}		</if>		<if test="nowPrice !=null and nowPrice !=''">		,#{nowPrice}		</if>		<if test="picture !=null and picture !=''">		,#{picture}		</if>		<if test="maxPicture !=null and maxPicture !=''">		,#{maxPicture}		</if>		<if test="productHTML !=null and productHTML !=''">		,#{productHTML}		</if>		<if test="score!=0">		,#{score}		</if>		<if test="isnew !=null and isnew!=''">		,#{isnew}		</if>		<if test="sale !=null and sale!=''">		,#{sale}		</if>		<if test="isRecommend !=null and isRecommend!=''">		,#{isRecommend}		</if>		<if test="unit!=null and unit!=''">		,#{unit}		</if>		<if test="activityID!=null and activityID!=''">		,#{activityID}		</if>		<if test="images!=null and images!=''">		,#{images}		</if>		<if test="searchKey!=null and searchKey!=''">		,#{searchKey}		</if>		<if test="title!=null and title!=''">		,#{title}		</if>		<if test="description!=null and description!=''">		,#{description}		</if>		<if test="keywords!=null and keywords!=''">		,#{keywords}		</if>		<if test="isTimePromotion!=null and isTimePromotion!=''">		,#{isTimePromotion}		</if>		<if test="giftID!=null">		,#{giftID}		</if>	)</insert>		<!-- 更新后台商品信息，若其他地方需要更新商品部分数据，请另外写方法，此方法仅仅用于更新商品全部数据（此方法不作为通用update方法调用，否则会导致部分字段的数据丢失，切记。） -->	<update id="manage.product.update" parameterType="net.jeeshop.services.manage.product.bean.Product">		update t_product		  set id=#{id},updatetime=now(),updateAccount=#{updateAccount}		,score=#{score}		,giftID = #{giftID}		<if test="isnew !=null and isnew!=''">		,isnew=#{isnew}		</if>		<if test="sale !=null and sale!=''">		,sale=#{sale}		</if>		<if test="isRecommend !=null and isRecommend!=''">		,isRecommend=#{isRecommend}		</if>		<if test="status != 0">		,status=#{status}		</if>		<if test="name !=null and name !=''">		,name=#{name}		</if>		<if test="introduce !=null and introduce !=''">		,introduce=#{introduce}		</if>		<if test="price !=null and price !=''">		,price=#{price}		</if>		<if test="nowPrice !=null and nowPrice !=''">		,nowPrice=#{nowPrice}		</if>		<if test="picture !=null and picture !=''">		,picture=#{picture}		</if>		<if test="maxPicture !=null and maxPicture !=''">		,maxPicture=#{maxPicture}		</if>		<if test="productHTML !=null and productHTML !=''">		,productHTML=#{productHTML}		</if>		<if test="createtime !=null and createtime !=''">		,createtime=#{createtime}		</if>		<if test="activityID!=null and activityID!=''">		,activityID = #{activityID}		</if>		<if test="images!=null and images!=''">		,images=#{images}		</if>		<if test="searchKey!=null and searchKey!=''">		,searchKey=#{searchKey}		</if>		<if test="title!=null and title!=''">		,title=#{title}		</if>		<if test="description!=null and description!=''">		,description=#{description}		</if>		<if test="keywords!=null and keywords!=''">		,keywords=#{keywords}		</if>		<if test="isTimePromotion!=null and isTimePromotion!=''">		,isTimePromotion=#{isTimePromotion}		</if>		 where 1=1 and id=#{id}	</update>		<select id="manage.product.selectOne" parameterType="net.jeeshop.services.manage.product.bean.Product" resultType="net.jeeshop.services.manage.product.bean.Product">	 select * 	 from t_product t, 	 left join t_product_catalog_rela r	 on p.id = r.productId	 where 1=1 		 <if test="id!=null and id!=''">		 	and id=#{id}		 </if>	 	<if test="status != 0">			and status=#{status}		</if>		 <if test="catalogID!=null and catalogID!=''">		 	and r.catalogId=#{catalogID}		 </if>		 <if test="name!=null and name!=''">				and t.name like CONCAT('%','${name}','%' ) 		 </if>	</select>		<select id="manage.product.selectById" parameterType="string" resultMap="ProductMap">	 	select p.id,p.name,p.introduce,p.price,p.nowPrice,p.picture,DATE_FORMAT(p.createtime,'%Y-%m-%d') createtime,p.createAccount,p.updateAccount,p.updatetime,p.isnew,p.sale,p.status,	 	p.productHTML,p.maxPicture,p.images,ts.sellcount,s.stock,p.searchKey,p.title,p.description,p.keywords,p.activityID,p.unit,p.score ,p.isTimePromotion ,p.isRecommend,p.giftID,	 	r.productId, r.catalogId   		 from t_product p		 left join t_product_catalog_rela r		 on p.id = r.productId		 left join t_product_stock s		 on p.id = s.productId		 left join t_product_hit h		 on p.id = h.productId		 left join t_product_sellcount ts		 on p.id = ts.productId 		  where p.id=#{id}	</select>		<select id="manage.product.selectProductCatalog" parameterType="long" resultType="com.tuisitang.modules.shop.entity.ProductCatalogRela">		select t.productId, t.catalogId from t_product_catalog_rela t where t.productId = #{productId}	</select>		<delete id="manage.product.deleteById" parameterType="int">		delete from t_product where 1=1 and id=#{id}	</delete>		<delete id="manage.product.deleteAttributeLinkByProductID" parameterType="int">		delete from t_attribute_link where productID=#{productID}	</delete>		<select id="manage.product.selectStockByIDs" parameterType="list" resultType="net.jeeshop.services.manage.product.bean.Product">	 select id,stock from t_product_stock t where 1=1 	 and id in <foreach item="item" index="index" collection="list" open="(" separator="," close=")">    			#{item}   		</foreach>	</select>		<select id="manage.product.selectOutOfStockProductCount" resultType="int">	 select count(*) from t_product t join t_product_stock r	 on t.id = r.productId where 1=1 and t.status=2 and r.stock &lt;= 0	</select>	<update id="manage.product.updateImg" parameterType="net.jeeshop.services.manage.product.bean.Product">		update t_product		  set id=#{id},picture=#{picture},isnew=#{isnew},sale=#{sale}		 where 1=1 and id=#{id}	</update>		<update id="manage.product.updateProductStatus" parameterType="net.jeeshop.services.manage.product.bean.Product">		update t_product set status=#{status},updateAccount=#{updateAccount},updatetime=now() where 1=1 and id=#{id} 	</update>		<update id="manage.product.updateProductBindActivityId" parameterType="net.jeeshop.services.manage.product.bean.Product">		 update t_product set activityID=#{activityID} 		 where id in <foreach item="item" index="index" collection="productIds" open="(" separator="," close=")">    			#{item}   		</foreach>	</update>		<update id="manage.product.updateResetThisProductActivityID" parameterType="string">		 update t_product set activityID=null where activityID=#{activityID}	</update>	</mapper>